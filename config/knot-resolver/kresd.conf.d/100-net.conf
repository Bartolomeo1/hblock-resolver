-- Listen on defined interfaces

local nicname = env.KRESD_NIC
local addresses = nil

if nicname == nil or nicname == '' then
	io.stdout:write('Listening on all interfaces\n')
	addresses = {'0.0.0.0'}
elseif net[nicname] ~= nil then
	io.stdout:write('Listening on '..nicname..' interface\n')
	addresses = net[nicname]
else
	io.stderr:write('Cannot find '..nicname..' interface\n')
	os.exit(1)
end

net.tls('/var/lib/knot-resolver/ssl/server.crt', '/var/lib/knot-resolver/ssl/server.key')
net.listen(addresses, 53)
net.listen(addresses, 853, {tls = true})
